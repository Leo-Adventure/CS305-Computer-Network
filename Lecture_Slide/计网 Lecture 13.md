## 计网 Lecture 13

### 回顾

通用转发(generalized forwarding)：不仅仅根据目的地进行下一跳路径的选择，并且动作也不止转发

控制平面转发算法

每一个路由器等待邻居发送距离向量，并根据这个距离向量去更新转发表，如果距离改变，则还需要通知邻居节点做更新

分布式(distributed)：并不知道全局的网络拓扑，只知道邻居到附近的最短路径的值。

迪杰斯特拉算法需要每一个路由器去进行全局广播，才能计算最终的路径，所以在实际当中使用bellmanFord 算法。

### 距离向量（distance vector）（BellmanFord）

只需要计算下一跳是哪一个路由器即可，初始化除了邻居，距离都是 $\infin$，所有节点都会发送自己的距离向量给邻居，每一个节点在接收完邻居的距离向量之后进行计算与更新，并进行传递 + 更新，直到最后距离向量不再改变，整个迭代停止。是一个异步算法，不需要等待所有节点才能更新。

#### 优点

- 链路代价变小的消息传递地很快，产生很迅速的影响

- 链路代价变大的消息传递地很慢，需要不断反复更新

### 链路状态与距离向量对比

链路状态：$O(N^2)$ 的消息复杂度，速度比较稳定，鲁棒性好（只计算自己的路由，影响的都是本地的运算）

距离向量：收敛的时间难以估计，速度不稳定（可能有路由环路、无穷问题），鲁棒性不好（任何一个路由器出错，错误的代价非常高（黑洞问题，错误传遍网络））

### ISP 之间的路由（OSPF）

之前讲的算法都是比较理想化的场景，假设所有路由器都是一样的，且网络没有层级结构，这样会导致以下问题

- 路由器数量很多的时候，如果每一个路由器都需要维护一个路由表，则会造成路由表的规模非常大。
- 路由表本身也是一个市场，则每一个服务商都会进行相互的竞争，与 ISP 管理自治冲突

每一个 自治系统 (AS) 内部有自己的路由算法，在 AS 边缘，需要一个网关路由器，负责和其他的 AS 进行连接以及信息交互。网关路由处理来自其他 AS 传递过来的路由

### BGP（边界网关协议）

